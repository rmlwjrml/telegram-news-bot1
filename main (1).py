
import requests
from bs4 import BeautifulSoup
import telegram
import time
from threading import Thread

keywords = ['í‚¤ì›Œë“œ1', 'í‚¤ì›Œë“œ2', 'í‚¤ì›Œë“œ3', 'í‚¤ì›Œë“œ4', 'í‚¤ì›Œë“œ5', 'í‚¤ì›Œë“œ6', 'í‚¤ì›Œë“œ7', 'í‚¤ì›Œë“œ8', 'í‚¤ì›Œë“œ9', 'í‚¤ì›Œë“œ10', 'í‚¤ì›Œë“œ11', 'í‚¤ì›Œë“œ12', 'í‚¤ì›Œë“œ13', 'í‚¤ì›Œë“œ14', 'í‚¤ì›Œë“œ15', 'í‚¤ì›Œë“œ16', 'í‚¤ì›Œë“œ17', 'í‚¤ì›Œë“œ18', 'í‚¤ì›Œë“œ19', 'í‚¤ì›Œë“œ20', 'í‚¤ì›Œë“œ21', 'í‚¤ì›Œë“œ22', 'í‚¤ì›Œë“œ23', 'í‚¤ì›Œë“œ24', 'í‚¤ì›Œë“œ25', 'í‚¤ì›Œë“œ26', 'í‚¤ì›Œë“œ27', 'í‚¤ì›Œë“œ28', 'í‚¤ì›Œë“œ29', 'í‚¤ì›Œë“œ30', 'í‚¤ì›Œë“œ31', 'í‚¤ì›Œë“œ32', 'í‚¤ì›Œë“œ33', 'í‚¤ì›Œë“œ34', 'í‚¤ì›Œë“œ35', 'í‚¤ì›Œë“œ36', 'í‚¤ì›Œë“œ37', 'í‚¤ì›Œë“œ38', 'í‚¤ì›Œë“œ39', 'í‚¤ì›Œë“œ40', 'í‚¤ì›Œë“œ41', 'í‚¤ì›Œë“œ42', 'í‚¤ì›Œë“œ43', 'í‚¤ì›Œë“œ44', 'í‚¤ì›Œë“œ45', 'í‚¤ì›Œë“œ46', 'í‚¤ì›Œë“œ47', 'í‚¤ì›Œë“œ48', 'í‚¤ì›Œë“œ49', 'í‚¤ì›Œë“œ50', 'í‚¤ì›Œë“œ51', 'í‚¤ì›Œë“œ52', 'í‚¤ì›Œë“œ53', 'í‚¤ì›Œë“œ54', 'í‚¤ì›Œë“œ55', 'í‚¤ì›Œë“œ56', 'í‚¤ì›Œë“œ57', 'í‚¤ì›Œë“œ58', 'í‚¤ì›Œë“œ59', 'í‚¤ì›Œë“œ60', 'í‚¤ì›Œë“œ61', 'í‚¤ì›Œë“œ62', 'í‚¤ì›Œë“œ63', 'í‚¤ì›Œë“œ64', 'í‚¤ì›Œë“œ65', 'í‚¤ì›Œë“œ66', 'í‚¤ì›Œë“œ67', 'í‚¤ì›Œë“œ68', 'í‚¤ì›Œë“œ69', 'í‚¤ì›Œë“œ70', 'í‚¤ì›Œë“œ71', 'í‚¤ì›Œë“œ72', 'í‚¤ì›Œë“œ73', 'í‚¤ì›Œë“œ74', 'í‚¤ì›Œë“œ75', 'í‚¤ì›Œë“œ76', 'í‚¤ì›Œë“œ77', 'í‚¤ì›Œë“œ78', 'í‚¤ì›Œë“œ79', 'í‚¤ì›Œë“œ80', 'í‚¤ì›Œë“œ81', 'í‚¤ì›Œë“œ82', 'í‚¤ì›Œë“œ83', 'í‚¤ì›Œë“œ84', 'í‚¤ì›Œë“œ85', 'í‚¤ì›Œë“œ86', 'í‚¤ì›Œë“œ87', 'í‚¤ì›Œë“œ88', 'í‚¤ì›Œë“œ89', 'í‚¤ì›Œë“œ90', 'í‚¤ì›Œë“œ91', 'í‚¤ì›Œë“œ92', 'í‚¤ì›Œë“œ93', 'í‚¤ì›Œë“œ94', 'í‚¤ì›Œë“œ95', 'í‚¤ì›Œë“œ96', 'í‚¤ì›Œë“œ97', 'í‚¤ì›Œë“œ98', 'í‚¤ì›Œë“œ99', 'í‚¤ì›Œë“œ100', 'í‚¤ì›Œë“œ101', 'í‚¤ì›Œë“œ102', 'í‚¤ì›Œë“œ103', 'í‚¤ì›Œë“œ104', 'í‚¤ì›Œë“œ105', 'í‚¤ì›Œë“œ106', 'í‚¤ì›Œë“œ107', 'í‚¤ì›Œë“œ108', 'í‚¤ì›Œë“œ109', 'í‚¤ì›Œë“œ110', 'í‚¤ì›Œë“œ111', 'í‚¤ì›Œë“œ112', 'í‚¤ì›Œë“œ113', 'í‚¤ì›Œë“œ114', 'í‚¤ì›Œë“œ115', 'í‚¤ì›Œë“œ116', 'í‚¤ì›Œë“œ117', 'í‚¤ì›Œë“œ118', 'í‚¤ì›Œë“œ119', 'í‚¤ì›Œë“œ120', 'í‚¤ì›Œë“œ121', 'í‚¤ì›Œë“œ122', 'í‚¤ì›Œë“œ123', 'í‚¤ì›Œë“œ124', 'í‚¤ì›Œë“œ125', 'í‚¤ì›Œë“œ126', 'í‚¤ì›Œë“œ127', 'í‚¤ì›Œë“œ128', 'í‚¤ì›Œë“œ129', 'í‚¤ì›Œë“œ130', 'í‚¤ì›Œë“œ131', 'í‚¤ì›Œë“œ132', 'í‚¤ì›Œë“œ133', 'í‚¤ì›Œë“œ134', 'í‚¤ì›Œë“œ135', 'í‚¤ì›Œë“œ136', 'í‚¤ì›Œë“œ137', 'í‚¤ì›Œë“œ138', 'í‚¤ì›Œë“œ139', 'í‚¤ì›Œë“œ140', 'í‚¤ì›Œë“œ141', 'í‚¤ì›Œë“œ142', 'í‚¤ì›Œë“œ143', 'í‚¤ì›Œë“œ144', 'í‚¤ì›Œë“œ145', 'í‚¤ì›Œë“œ146', 'í‚¤ì›Œë“œ147', 'í‚¤ì›Œë“œ148', 'í‚¤ì›Œë“œ149', 'í‚¤ì›Œë“œ150', 'í‚¤ì›Œë“œ151', 'í‚¤ì›Œë“œ152', 'í‚¤ì›Œë“œ153', 'í‚¤ì›Œë“œ154', 'í‚¤ì›Œë“œ155', 'í‚¤ì›Œë“œ156', 'í‚¤ì›Œë“œ157', 'í‚¤ì›Œë“œ158', 'í‚¤ì›Œë“œ159', 'í‚¤ì›Œë“œ160', 'í‚¤ì›Œë“œ161', 'í‚¤ì›Œë“œ162', 'í‚¤ì›Œë“œ163', 'í‚¤ì›Œë“œ164', 'í‚¤ì›Œë“œ165', 'í‚¤ì›Œë“œ166', 'í‚¤ì›Œë“œ167', 'í‚¤ì›Œë“œ168', 'í‚¤ì›Œë“œ169', 'í‚¤ì›Œë“œ170', 'í‚¤ì›Œë“œ171', 'í‚¤ì›Œë“œ172', 'í‚¤ì›Œë“œ173', 'í‚¤ì›Œë“œ174', 'í‚¤ì›Œë“œ175', 'í‚¤ì›Œë“œ176', 'í‚¤ì›Œë“œ177', 'í‚¤ì›Œë“œ178', 'í‚¤ì›Œë“œ179', 'í‚¤ì›Œë“œ180', 'í‚¤ì›Œë“œ181', 'í‚¤ì›Œë“œ182', 'í‚¤ì›Œë“œ183', 'í‚¤ì›Œë“œ184', 'í‚¤ì›Œë“œ185', 'í‚¤ì›Œë“œ186', 'í‚¤ì›Œë“œ187', 'í‚¤ì›Œë“œ188', 'í‚¤ì›Œë“œ189', 'í‚¤ì›Œë“œ190', 'í‚¤ì›Œë“œ191', 'í‚¤ì›Œë“œ192', 'í‚¤ì›Œë“œ193', 'í‚¤ì›Œë“œ194', 'í‚¤ì›Œë“œ195', 'í‚¤ì›Œë“œ196', 'í‚¤ì›Œë“œ197', 'í‚¤ì›Œë“œ198', 'í‚¤ì›Œë“œ199', 'í‚¤ì›Œë“œ200']

bots = {
    "A": {"token": "7440645018:AAG_yFBsdyaMmhK_He7lI3EBWggLK9wenXg", "chat_id": "5639589613"},
    "B": {"token": "7440645018:AAG_yFBsdyaMmhK_He7lI3EBWggLK9wenXg", "chat_id": "5639589613"},
    "C": {"token": "7513053048:AAGhoPamVwZhGYqztK0huXWxg0FQ1W204fI", "chat_id": "5639589613"}
}

channels = [{'name': 'ì±„ë„1', 'url': 'https://news.example.com/channel1', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„2', 'url': 'https://news.example.com/channel2', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„3', 'url': 'https://news.example.com/channel3', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„4', 'url': 'https://news.example.com/channel4', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„5', 'url': 'https://news.example.com/channel5', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„6', 'url': 'https://news.example.com/channel6', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„7', 'url': 'https://news.example.com/channel7', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„8', 'url': 'https://news.example.com/channel8', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„9', 'url': 'https://news.example.com/channel9', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„10', 'url': 'https://news.example.com/channel10', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„11', 'url': 'https://news.example.com/channel11', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„12', 'url': 'https://news.example.com/channel12', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„13', 'url': 'https://news.example.com/channel13', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„14', 'url': 'https://news.example.com/channel14', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„15', 'url': 'https://news.example.com/channel15', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„16', 'url': 'https://news.example.com/channel16', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„17', 'url': 'https://news.example.com/channel17', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„18', 'url': 'https://news.example.com/channel18', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„19', 'url': 'https://news.example.com/channel19', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„20', 'url': 'https://news.example.com/channel20', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„21', 'url': 'https://news.example.com/channel21', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„22', 'url': 'https://news.example.com/channel22', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„23', 'url': 'https://news.example.com/channel23', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„24', 'url': 'https://news.example.com/channel24', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„25', 'url': 'https://news.example.com/channel25', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„26', 'url': 'https://news.example.com/channel26', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„27', 'url': 'https://news.example.com/channel27', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„28', 'url': 'https://news.example.com/channel28', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„29', 'url': 'https://news.example.com/channel29', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„30', 'url': 'https://news.example.com/channel30', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„31', 'url': 'https://news.example.com/channel31', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„32', 'url': 'https://news.example.com/channel32', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„33', 'url': 'https://news.example.com/channel33', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„34', 'url': 'https://news.example.com/channel34', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„35', 'url': 'https://news.example.com/channel35', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„36', 'url': 'https://news.example.com/channel36', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„37', 'url': 'https://news.example.com/channel37', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„38', 'url': 'https://news.example.com/channel38', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„39', 'url': 'https://news.example.com/channel39', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„40', 'url': 'https://news.example.com/channel40', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„41', 'url': 'https://news.example.com/channel41', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„42', 'url': 'https://news.example.com/channel42', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„43', 'url': 'https://news.example.com/channel43', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„44', 'url': 'https://news.example.com/channel44', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„45', 'url': 'https://news.example.com/channel45', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„46', 'url': 'https://news.example.com/channel46', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„47', 'url': 'https://news.example.com/channel47', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„48', 'url': 'https://news.example.com/channel48', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„49', 'url': 'https://news.example.com/channel49', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„50', 'url': 'https://news.example.com/channel50', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„51', 'url': 'https://news.example.com/channel51', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„52', 'url': 'https://news.example.com/channel52', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„53', 'url': 'https://news.example.com/channel53', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„54', 'url': 'https://news.example.com/channel54', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„55', 'url': 'https://news.example.com/channel55', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„56', 'url': 'https://news.example.com/channel56', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„57', 'url': 'https://news.example.com/channel57', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„58', 'url': 'https://news.example.com/channel58', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„59', 'url': 'https://news.example.com/channel59', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„60', 'url': 'https://news.example.com/channel60', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„61', 'url': 'https://news.example.com/channel61', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„62', 'url': 'https://news.example.com/channel62', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„63', 'url': 'https://news.example.com/channel63', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„64', 'url': 'https://news.example.com/channel64', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„65', 'url': 'https://news.example.com/channel65', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„66', 'url': 'https://news.example.com/channel66', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„67', 'url': 'https://news.example.com/channel67', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„68', 'url': 'https://news.example.com/channel68', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„69', 'url': 'https://news.example.com/channel69', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„70', 'url': 'https://news.example.com/channel70', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„71', 'url': 'https://news.example.com/channel71', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„72', 'url': 'https://news.example.com/channel72', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„73', 'url': 'https://news.example.com/channel73', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„74', 'url': 'https://news.example.com/channel74', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„75', 'url': 'https://news.example.com/channel75', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„76', 'url': 'https://news.example.com/channel76', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„77', 'url': 'https://news.example.com/channel77', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„78', 'url': 'https://news.example.com/channel78', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„79', 'url': 'https://news.example.com/channel79', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„80', 'url': 'https://news.example.com/channel80', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„81', 'url': 'https://news.example.com/channel81', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„82', 'url': 'https://news.example.com/channel82', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„83', 'url': 'https://news.example.com/channel83', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„84', 'url': 'https://news.example.com/channel84', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„85', 'url': 'https://news.example.com/channel85', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„86', 'url': 'https://news.example.com/channel86', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„87', 'url': 'https://news.example.com/channel87', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„88', 'url': 'https://news.example.com/channel88', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„89', 'url': 'https://news.example.com/channel89', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„90', 'url': 'https://news.example.com/channel90', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„91', 'url': 'https://news.example.com/channel91', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„92', 'url': 'https://news.example.com/channel92', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„93', 'url': 'https://news.example.com/channel93', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„94', 'url': 'https://news.example.com/channel94', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„95', 'url': 'https://news.example.com/channel95', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„96', 'url': 'https://news.example.com/channel96', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„97', 'url': 'https://news.example.com/channel97', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„98', 'url': 'https://news.example.com/channel98', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„99', 'url': 'https://news.example.com/channel99', 'selector': 'ul.news_list li a'}, {'name': 'ì±„ë„100', 'url': 'https://news.example.com/channel100', 'selector': 'ul.news_list li a'}]

sent_messages = set()

def check_and_send(bot_token, chat_id, news_item):
    text, link = news_item
    if any(k in text for k in keywords) and text not in sent_messages:
        try:
            bot = telegram.Bot(token=bot_token)
            bot.send_message(chat_id=chat_id, text=f"ğŸ“¢ {text}\n{link}")
            sent_messages.add(text)
        except Exception as e:
            print("ì „ì†¡ ì‹¤íŒ¨:", e)

def scrape_site(bot_name, urls):
    bot_token = bots[bot_name]['token']
    chat_id = bots[bot_name]['chat_id']
    while True:
        for site in urls:
            try:
                res = requests.get(site['url'], timeout=10)
                soup = BeautifulSoup(res.text, 'html.parser')
                links = soup.select(site['selector'])
                for a in links[:10]:
                    title = a.get_text(strip=True)
                    href = a.get('href')
                    if not href.startswith('http'):
                        href = site['url'].split('/')[0] + '//' + site['url'].split('/')[2] + href
                    check_and_send(bot_token, chat_id, (title, href))
            except Exception as e:
                print(f"[ì˜¤ë¥˜] {site['name']}: ", e)
        time.sleep(30)

if __name__ == "__main__":
    chunk = len(channels) // 3
    Thread(target=scrape_site, args=("A", channels[:chunk])).start()
    Thread(target=scrape_site, args=("B", channels[chunk:2*chunk])).start()
    Thread(target=scrape_site, args=("C", channels[2*chunk:])).start()
